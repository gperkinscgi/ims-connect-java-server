groups:
- name: ims-connect-alerts
  rules:
  - alert: IMSConnectServerDown
    expr: up{job="ims-connect-server"} == 0
    for: 30s
    labels:
      severity: critical
    annotations:
      summary: "IMS Connect Server is down"
      description: "IMS Connect Server has been down for more than 30 seconds."

  - alert: HighCPUUsage
    expr: rate(process_cpu_usage[5m]) > 0.8
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "High CPU usage detected"
      description: "CPU usage is above 80% for more than 5 minutes."

  - alert: HighMemoryUsage
    expr: jvm_memory_used_bytes / jvm_memory_max_bytes > 0.9
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "High memory usage detected"
      description: "Memory usage is above 90% for more than 5 minutes."

  - alert: HighErrorRate
    expr: rate(http_server_requests_seconds_count{status=~"5.."}[5m]) > 0.1
    for: 2m
    labels:
      severity: critical
    annotations:
      summary: "High error rate detected"
      description: "Error rate is above 10% for more than 2 minutes."

  - alert: ConnectionPoolExhausted
    expr: ims_connect_pool_active_connections / ims_connect_pool_max_connections > 0.9
    for: 1m
    labels:
      severity: warning
    annotations:
      summary: "Connection pool nearly exhausted"
      description: "Connection pool usage is above 90% for more than 1 minute."

  - alert: BackendUnhealthy
    expr: ims_connect_backend_health_status == 0
    for: 30s
    labels:
      severity: critical
    annotations:
      summary: "Backend connection unhealthy"
      description: "Backend {{ $labels.backend }} is unhealthy."